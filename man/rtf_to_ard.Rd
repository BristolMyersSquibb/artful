% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/convert.R, R/ellmer.R
\name{rtf_to_ard}
\alias{rtf_to_ard}
\title{Convert an RTF Table into an ARD data frame}
\usage{
rtf_to_ard(rtf)

rtf_to_ard(rtf)
}
\arguments{
\item{rtf}{Character string specifying the path to an RTF file containing a
clinical trial table to be converted to ARD format.}

\item{file}{A string, the path to the input .rtf file.}
}
\value{
an R data frame following the ARD standard.

A \code{tibble} containing the extracted ARD records with columns:
\describe{
\item{table_id}{Table identifier from title (optional)}
\item{group1, group1_level}{First grouping variable and its level (optional)}
\item{group2, group2_level}{Second grouping variable and its level (optional)}
\item{group3, group3_level}{Third grouping variable and its level (optional)}
\item{variable}{Primary variable being analyzed}
\item{variable_level}{Level for categorical variables (optional)}
\item{stat_name}{Standardized statistic name from ARD mapping}
\item{stat_label}{Human-readable statistic label}
\item{stat}{The statistical value as string}
}
}
\description{
This function converts a table in RTF format into a data frame in R,
following the ARD standard. This is the top-level function of this package
which acts as a glue to the lower-level functions.

Extracts structured statistical data from RTF-formatted clinical trial tables
and converts them to ARD (Analysis Results Data) standard format using
Large Language Model (LLM) processing with structured data extraction.
}
\details{
This function performs the following steps:
\enumerate{
\item Converts the input RTF file to PDF format for visual processing
\item Converts the RTF to HTML for text extraction
\item Uses multi-shot prompting with three example RTF/PDF pairs to guide
the LLM in understanding the expected output format
\item Employs structured data extraction via \code{chat_structured()} to
ensure the output conforms to ARD standards
\item Returns results as a tibble for easy manipulation in R
}
}
\note{
Requires valid OpenAI API credentials to be configured. The function
relies on example files included in the package for multi-shot prompting.
}
\examples{
\dontrun{
rtf_to_ard(rtf_example(4))
}
\dontrun{
rtf_file <- system.file("prompts","example-4.rtf", package = "artful")
rtf_to_ard(rtf = rtf_file)
}

}
